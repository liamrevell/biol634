library(phytools)
data("liolaemid.data")
data("liolaemid.tree")
head(liolaemid.data)
liolaemid.data<-liolaemid.data[-1,]
parity<-setNames(liolaemid.data$parity_mode,
rownames(liolaemid.data))
temperature<-setNames(liolaemid.data$temperature,
rownames(liolaemid.data))
fit<-fitcontMk(liolaemid.tree,parity,temperature,
parallel=TRUE,ncores=10,levs=20)
fit
fit<-fitcontMk(liolaemid.tree,parity,temperature,
parallel=TRUE,ncores=10,levs=20,trace=2)
getwd()
setwd("../../documents/CV")
20000+29250+80592+1400+1500+3000+8300+2000+3500
ls()
plot(fit)
fit
list.files()
setwd("../../presentations/UConn.2025/")
list.files()
load("liolaemid_results.RData")
ls()
fit
Q<-matrix(c(-1,1,1,-1),2,2,dimnames=list(0:1,0:1))
true_tree<-pbtree(n=40,scale=1)
X<-sim.Mk(tree,Q,nsim=100)
library(phangorn)
Q<-matrix(c(-1,1,1,-1),2,2,dimnames=list(0:1,0:1))
true_tree<-pbtree(n=40,scale=1)
X<-sim.Mk(tree,Q,nsim=100)
X<-sim.Mk(true_tree,Q,nsim=100)
X
Data<-as.phyDat(X,type="USER")
Data<-as.phyDat(X,type="USER",levels=c(0,1))
Data
Data<-as.phyDat(t(X),type="USER",levels=c(0,1))
Data
Data<-as.phyDat(as.matrix(X),type="USER",levels=c(0,1))
Data
Data
fit<-pml_bb(Data)
fit<-pml_bb(Data,model="ER")
fit
plot(fit)
dev.off()
plot(fit)
plotTree(midpoint(fit$tree))
plot(cophylo(true_tree,midpoint(fit$tree)))
library(phangorn)
Q<-matrix(c(-1,1,1,-1),2,2,dimnames=list(0:1,0:1))
true_tree<-pbtree(n=40,scale=1)
X<-sim.Mk(true_tree,Q,nsim=1000)
Data<-as.phyDat(as.matrix(X),type="USER",levels=c(0,1))
Data
fit<-pml_bb(Data,model="ER")
dev.off()
plotTree(midpoint(fit$tree))
plot(cophylo(true_tree,midpoint(fit$tree)))
fit<-pml_bb(Data,model="ER",rearrangement="stochastic")
?fitcontMk
getwd()
setwd("../../")
getwd()
?bmPlot
library(phytools)
?bmPlot
?fitmultiBM
?fitThresh
?bounded_bm
?update.packages
update.packages(ask=FALSE,checkBuilt=TRUE)
update.packages(ask=FALSE,checkBuilt=TRUE)
packageVersion("phytools")
remotes::install_github("liamrevell/phytools")
library(phangorn)
library(phytools)
Jackman.data<-read.phyDat(
file="https://liamrevell.github.io/biol634/data/Jackman-etal.nex",
format="nexus")
Jackman.data
?download.file
setwd("../Desktop/")
download.file(
url="https://liamrevell.github.io/biol634/data/Jackman-etal.nex",
destfile="Jackman-etal.nex")
Jackman.data
length(Jackman.data)
names(Jackman.data)
jackmand_rand<-rtree(
n=length(Jackman.data),
tip.label=names(Jackman.data),
rooted=FALSE)
jackman_rand<-rtree(
n=length(Jackman.data),
tip.label=names(Jackman.data),
rooted=FALSE)
jackman_unfitted.pml<-pml(
tree=jackman_rand,
data=Jackman.data)
jackman_unfitted.pml
?pml
jackman_jc_fitted.pml<-optim.pml(
object=jackman_unfitted.pml,
optEdge=TRUE,
rearrangement="NNI")
class(jackman_jc_fitted.pml)
plot(jackman_jc_fitted.pml)
str(jackman_jc_fitted.pml)
jackman_jc.phy<-jackman_jc_fitted.pml$tree
plot(jackman_jc.phy)
plot(jackman_jc_fitted.pml)
plot(jackman_jc.phy)
names(Jackman.data)
"Diplolaemus_darwinii"
rooted.jackman_jc.phy<-root(jackman_jc.phy,
outgroup="Diplolaemus_darwinii")
plot(rooted.jackman_jc.phy)
rooted.jackman_jc.phy<-root(jackman_jc.phy,
outgroup="Diplolaemus_darwinii",resolve.root=TRUE)
plot(rooted.jackman_jc.phy)
plot(rooted.jackman_jc.phy,use.edge.length=FALSE)
plot(rooted.jackman_jc.phy) #,use.edge.length=FALSE)
jackman_jc_fitted.pml
jackman_mp<-pratchet(Jackman.data)
jackman_unfitted.pml<-pml(
tree=jackman_mp,
data=Jackman.data)
unclass(jackman_mp)
plot(jackman_mp)
jackman_mp<-runif(n=nrow(jackman_mp$edge))
plot(jackman_mp)
jackman_mp<-pratchet(Jackman.data)
plot(jackman_mp)
jackman_mp$edge.length<-runif(n=nrow(jackman_mp$edge))
plot(jackman_mp)
jackman_unfitted.pml<-pml(
tree=jackman_mp,
data=Jackman.data)
jackman_unfitted.pml
jackman_jc_fitted.pml
jackman_jc_fitted.pml<-optim.pml(
object=jackman_unfitted.pml,
optEdge=TRUE,
rearrangement="NNI")
jackman_jc.phy<-jackman_jc_fitted.pml$tree
plot(jackman_jc.phy)
rooted.jackman_jc.phy<-root(
jackman_jc.phy,
outgroup="Diplolaemus_darwinii"
resolve.root=TRUE)
rooted.jackman_jc.phy<-root(
jackman_jc.phy,
outgroup="Diplolaemus_darwinii",
resolve.root=TRUE)
plotTree(rooted.jackman_jc.phy)
jackman_jc_fitted.pml.2<-pml_bb(Jackman.data,model="JC")
jackman_k80_fitted.pml<-pml_bb(Jackman.data,model="K80")
getwd()
setwd("courses")
setwd("../Dropbox/courses")
setwd("BIOL634-fall2025")
setwd("biol364")
setwd("biol634/")
setwd("ex/4")
list.files()
setwd("../../")
list.files()
