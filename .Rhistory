fit
x<--0.25
1-ceiling(x)-x
1-ceiling(x)+x
x<-2.25
1-ceiling(x)+x
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
library(phytools)
tree<-pbtree(n=100)
x_bm<-fastBM(tree,sig2=0.5)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE)
fit
library(phytools)
tree<-pbtree(n=100)
x_bm<-fastBM(tree,sig2=2)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE)
fit
library(phytools)
tree<-pbtree(n=200)
x_bm<-fastBM(tree,sig2=2)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE)
fit
library(phytools)
tree<-pbtree(n=500)
x_bm<-fastBM(tree,sig2=1.5)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE)
fit
library(phytools)
tree<-pbtree(n=500)
x_bm<-fastBM(tree,sig2=1.5)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit_wbm<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE)
fit_wbm
fit_bbm<-bounded_bm(tree,x,lims=c(0,1))
fit_bbm
fit_bm<-bounded_bm(tree,x)
fit_bm
geiger::fitContinuous(tree,x)
fit_bm<-bounded_bm(tree,x,lims=c(-2,2))
fit_bm
geiger::fitContinuous(tree,x)
tree<-pbtree(n=50)
x_bm<-fastBM(tree,sig2=1.5)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit_wbm<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE)
fit_wbm
fit_bbm<-bounded_bm(tree,x,lims=c(0,1))
fit_bbm
fit_bm<-bounded_bm(tree,x,lims=c(-2,2))
fit_bm
geiger::fitContinuous(tree,x)
anova(fit_wbm,fit_bbm,fit_bm)
AIC(fit_wbm,fit_bbm,fit_bm)
fit_bm<-bounded_bm(tree,x)
fit_bm
fit_bbm<-bounded_bm(tree,x,
lims=phytools:::expand.range(x,p=3))
fit_bbm
library(phytools)
tree<-pbtree(n=50)
x_bm<-fastBM(tree,sig2=1.5)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit_wbm<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE)
fit_wbm
fit_bbm<-bounded_bm(tree,x,
lims=phytools:::expand.range(x,p=3))
fit_bbm
fit_bm<-bounded_bm(tree,x)
fit_bm
AIC(fit_wbm,fit_bbm,fit_bm)
library(phytools)
N<-50
sig2<-10
tree<-pbtree(n=N)
x_bm<-fastBM(tree,sig2=sig2)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit_wbm<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE)
fit_wbm
fit_bbm<-bounded_bm(tree,x,lims=c(0,1))
fit_bbm
fit_bm<-bounded_bm(tree,x,
lims=phytools:::expand.range(x,p=3))
fit_bm
AIC(fit_wbm,fit_bbm,fit_bm)
fit_wbm
fit_bbm
fit_bm
geiger::fitContinuous(tree,x)
library(phytools)
N<-50
sig2<-20
tree<-pbtree(n=N)
x_bm<-fastBM(tree,sig2=sig2)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit_wbm<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE)
fit_wbm
fit_bbm<-bounded_bm(tree,x,lims=c(0,1))
fit_bbm
fit_bm<-bounded_bm(tree,x,
lims=phytools:::expand.range(x,p=3))
fit_bm
AIC(fit_wbm,fit_bbm,fit_bm)
args(fastBM)
?fastBM
library(phytools)
N<-50
sig2<-20
tree<-pbtree(n=N)
x_bm<-fastBM(tree,sig2=sig2,a=0.4)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit_wbm<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE)
fit_wbm
fit_bbm<-bounded_bm(tree,x,lims=c(0,1))
fit_bbm
fit_bm<-bounded_bm(tree,x,
lims=phytools:::expand.range(x,p=3))
fit_bm
AIC(fit_wbm,fit_bbm,fit_bm)
fit_bbm<-bounded_bm(tree,x,lims=c(0,1),df=2)
fit_bbm
AIC(fit_wbm,fit_bbm,fit_bm)
library(phytools)
N<-50
sig2<-2
tree<-pbtree(n=N)
x_bm<-fastBM(tree,sig2=sig2,a=0.4)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit_wbm<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE)
fit_wbm
fit_bbm<-bounded_bm(tree,x,lims=c(0,1),df=2)
fit_bbm
fit_bm<-bounded_bm(tree,x,
lims=phytools:::expand.range(x,p=3),
df=2)
fit_bm
AIC(fit_wbm,fit_bbm,fit_bm)
library(phytools)
N<-50
sig2<-0.5
tree<-pbtree(n=N)
x_bm<-fastBM(tree,sig2=sig2,a=0.4)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit_wbm<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE)
fit_wbm
fit_bbm<-bounded_bm(tree,x,lims=c(0,1),df=2)
fit_bbm
fit_bm<-bounded_bm(tree,x,
lims=phytools:::expand.range(x,p=3),
df=2)
fit_bm
AIC(fit_wbm,fit_bbm,fit_bm)
library(phytools)
N<-50
sig2<-0.1
tree<-pbtree(n=N)
x_bm<-fastBM(tree,sig2=sig2,a=0.4)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit_wbm<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE)
fit_wbm
fit_bbm<-bounded_bm(tree,x,lims=c(0,1),df=2)
fit_bbm
fit_bm<-bounded_bm(tree,x,
lims=phytools:::expand.range(x,p=3),
df=2)
fit_bm
AIC(fit_wbm,fit_bbm,fit_bm)
fit_wbm<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE,levs=100)
fit_wbm
fit_bbm<-bounded_bm(tree,x,lims=c(0,1),df=2,levs=100)
fit_bbm
fit_bm<-bounded_bm(tree,x,
lims=phytools:::expand.range(x,p=3),
df=2,levs=300)
geiger::fitContinuous(tree,x)
fit_bm
library(phytools)
N<-50
sig2<-0.1
tree<-pbtree(n=N)
x_bm<-fastBM(tree,sig2=sig2,a=0.4)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit_wbm<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE,levs=100)
fit_wbm
fit_bbm<-bounded_bm(tree,x,lims=c(0,1),df=2,levs=100)
fit_bbm
fit_bm<-bounded_bm(tree,x,
lims=phytools:::expand.range(x,p=3),
df=2,levs=300)
fit_bm
geiger::fitContinuous(tree,x)
AIC(fit_wbm,fit_bbm,fit_bm)
args(runif)
library(phytools)
N<-50
sig2<-runif(n=1,0,5)
sig2
a<-runif(n=1,0,1)
a
tree<-pbtree(n=N)
x_bm<-fastBM(tree,sig2=sig2,a=a)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit_wbm<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE,levs=100)
fit_wbm
fit_bbm<-bounded_bm(tree,x,lims=c(0,1),df=2,levs=100)
fit_bbm
fit_bm<-bounded_bm(tree,x,
lims=phytools:::expand.range(x,p=3),
df=2,levs=300)
fit_bm
geiger::fitContinuous(tree,x)
AIC(fit_wbm,fit_bbm,fit_bm)
library(phytools)
N<-200
sig2<-runif(n=1,0,5)
sig2
a<-runif(n=1,0,1)
a
tree<-pbtree(n=N)
x_bm<-fastBM(tree,sig2=sig2,a=a)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit_wbm<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE,levs=100)
fit_wbm
fit_bbm<-bounded_bm(tree,x,lims=c(0,1),df=2,levs=100)
fit_bbm
fit_bm<-bounded_bm(tree,x,
lims=phytools:::expand.range(x,p=3),
df=2,levs=300)
fit_bm
geiger::fitContinuous(tree,x)
AIC(fit_wbm,fit_bbm,fit_bm)
library(phytools)
N<-200
sig2<-runif(n=1,0,5)
sig2
a<-runif(n=1,0,1)
a
tree<-pbtree(n=N)
x_bm<-fastBM(tree,sig2=sig2,a=a)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit_wbm<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE,levs=100)
fit_wbm
fit_bbm<-bounded_bm(tree,x,lims=c(0,1),df=2,levs=100)
fit_bbm
fit_bm<-bounded_bm(tree,x,
lims=phytools:::expand.range(x,p=3),
df=2,levs=300)
library(phytools)
N<-400
sig2<-runif(n=1,0,5)
sig2
a<-runif(n=1,0,1)
a
tree<-pbtree(n=N)
x_bm<-fastBM(tree,sig2=sig2,a=a)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit_wbm<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE,levs=100)
fit_wbm
fit_bbm<-bounded_bm(tree,x,lims=c(0,1),df=2,levs=100)
fit_bbm
fit_bm<-bounded_bm(tree,x,
lims=phytools:::expand.range(x,p=3),
df=2,levs=300)
fit_bm
geiger::fitContinuous(tree,x)
AIC(fit_wbm,fit_bbm,fit_bm)
library(phytools)
N<-400
sig2<-runif(n=1,0,5)
sig2
a<-runif(n=1,0,1)
a
tree<-pbtree(n=N)
x_bm<-fastBM(tree,sig2=sig2,a=a)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit_wbm<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE,levs=100)
fit_wbm
fit_bbm<-bounded_bm(tree,x,lims=c(0,1),df=2,levs=100)
fit_bbm
fit_bm<-bounded_bm(tree,x,
lims=phytools:::expand.range(x,p=3),
df=2,levs=300)
AIC(fit_wbm,fit_bbm,geiger::fitContinuous(tree,x))
library(phytools)
N<-1000
sig2<-runif(n=1,0,5)
sig2
a<-runif(n=1,0,1)
a
tree<-pbtree(n=N)
x_bm<-fastBM(tree,sig2=sig2,a=a)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit_wbm<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE,levs=100)
fit_wbm
fit_bbm<-bounded_bm(tree,x,lims=c(0,1),df=2,levs=100)
fit_bbm
#fit_bm<-bounded_bm(tree,x,
#  lims=phytools:::expand.range(x,p=3),
#  df=2,levs=300)
#fit_bm
geiger::fitContinuous(tree,x)
AIC(fit_wbm,fit_bbm,geiger::fitContinuous(tree,x))
fit_wbm
sig2
a
fit_bbm
fit_bm
library(phytools)
N<-1000
sig2<-runif(n=1,0,5)
sig2
a<-runif(n=1,0,1)
a
tree<-pbtree(n=N)
x_bm<-fastBM(tree,sig2=sig2,a=a)
hist(x_bm)
foo<-function(x){
if(x>1) return(x-floor(x))
if(x<0) return(1-ceiling(x)+x)
else return(x)
}
x<-sapply(x_bm,foo)
hist(x)
fit_wbm<-bounded_bm(tree,x,lims=c(0,1),wrapped=TRUE,levs=100)
fit_wbm
fit_bbm<-bounded_bm(tree,x,lims=c(0,1),df=2,levs=100)
fit_bbm
#fit_bm<-bounded_bm(tree,x,
#  lims=phytools:::expand.range(x,p=3),
#  df=2,levs=300)
#fit_bm
geiger::fitContinuous(tree,x)
AIC(fit_wbm,fit_bbm,geiger::fitContinuous(tree,x))
remotes::install_github("liamrevell/phytools")
library(phytools)
data("liolaemid.data")
data("liolaemid.tree")
ls()
head(liolaemid.data)
parity<-setNames(liolaemid.data$parity_mode,
rownames(liolaemid.data))
temperature<-setNames(liolaemid.data$temperature,
rownames(liolaemid.data))
?fitcontMk
geiger::name.check(liolaemid.tree,liolaemid.data
)
chk<-geiger::name.check(liolaemid.tree,liolaemid.data)
liolaemid.data<-liolaemid.data[-1,]
head(liolaemid.data)
library(phytools)
data("liolaemid.data")
data("liolaemid.tree")
head(liolaemid.data)
liolaemid.data<-liolaemid.data[-1,]
parity<-setNames(liolaemid.data$parity_mode,
rownames(liolaemid.data))
temperature<-setNames(liolaemid.data$temperature,
rownames(liolaemid.data))
fit<-fitcontMk(liolaemid.tree,parity,temperature,
parallel=TRUE,ncores=10)
plot(fit)
save.image("C:/Users/liamj/Dropbox/presentations/UConn.2025/liolaemid_results.RData")
getwd()
setwd("courses/")
setwd("BIOL634-fall2025/biol634/")
